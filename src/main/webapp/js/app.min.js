/*! 
* FUNP - v1.0.0 
* © Copyright 2016  Liangli Huang
 */
$(function(){var a="http://118.178.124.197:8080/",b=angular.module("app",["ngRoute"]);b.service("productBackAction",function(){var a=!1,b=null,c=null,d=null,e=null;return{getProductBack:function(){return a},getType:function(){return b},getPublishState:function(){return c},getProductRecommend:function(){return d},getProductCategory:function(){return e},setProductBack:function(b){a=b},setType:function(a){b=a},setPublishState:function(a){c=a},setProductRecommend:function(a){d=a},setProductCategory:function(a){e=a}}}),b.config(function(a){a.when("/primary_product",{templateUrl:"app/views/product/primary_product.html",controller:"primaryProductCtrl"}).when("/product_list",{templateUrl:"app/views/product/product_list.html",controller:"productListCtrl"}).when("/new_ar_product_detail/:productID",{templateUrl:"app/views/product/new_ar_product_detail.html",controller:"updateARProductDetail"}).when("/new_ar_product_detail",{templateUrl:"app/views/product/new_ar_product_detail.html",controller:"newARDetailCtrl"}).when("/new_video_product_detail/:productID",{templateUrl:"app/views/product/new_video_product_detail.html",controller:"updateVideoDetailCtrl"}).when("/new_video_product_detail",{templateUrl:"app/views/product/new_video_product_detail.html",controller:"newVideoDetailCtrl"}).when("/first_level_category",{templateUrl:"app/views/category/first_level_category.html",controller:"firstLevelCategoryCtrl"}).when("/second_level_category",{templateUrl:"app/views/category/second_level_category.html",controller:"secondLevelCategoryCtrl"}).when("/user_admin",{templateUrl:"app/views/user/user_admin.html",controller:"userAdminCtrl"}).when("/log_download",{templateUrl:"app/views/log/log_download.html",controller:"logDownloadCtrl"}).otherwise("/primary_product",{templateUrl:"app/views/product/primary_product.html",controller:"otherUrlCtrl"})}),b.controller("primaryProductCtrl",function(){console.log("Arrived at primary product page already!!")}),b.controller("productListCtrl",function(b,c,d){b.productItems=null,b.productItems_selected=[],b.actionSelected="",b.productItems_copy=[],loading(),b.productCategoryList=["故事","国学","拼音"],b.productCategory=b.productCategoryList[0],b.publishState="上架",b.productType="视频产品",b.recommendation="是",b.searchProductListByFilters=function(){console.log("Starting to search product items by filters..."),console.log("Selected product category: "+b.productCategory+" Selected index: "+$("#product_category").prop("selectedIndex")),console.log("Selected product type: "+b.productType+" Selected index: "+$("#product_type").prop("selectedIndex")),console.log("Selected publish state: "+b.publishState+" Selected index: "+$("#publish_state").prop("selectedIndex")),console.log("Selected recommendation: "+b.recommendation+" Selected index: "+$("#recommendation").prop("selectedIndex"));var e={};d.getProductBack()?(e.type=d.getType(),e.publishState=d.getPublishState(),e.productRecommend=d.getProductRecommend(),e.productCategory=d.getProductCategory(),b.productCategory=d.getProductCategory(),b.publishState=0==d.getPublishState()?"上架":"下架",b.productType=0==d.getType()?"视频产品":"AR产品",b.recommendation=0==d.getProductRecommend()?"是":"否"):(e.type=$("#product_type").prop("selectedIndex"),e.publishState=$("#publish_state").prop("selectedIndex"),e.productRecommend=$("#recommendation").prop("selectedIndex"),e.productCategory=b.productCategory),d.setProductBack(!1),c.post(a+"eden/prods/lists",e).then(function(a){console.log("Get product list by filter successfully."),b.productItems=a.data,b.productItems_copy=a.data,b.productItems_selected=[]},function(a){console.log("Failed to get product list by filter")})},b.searchProductListByFilters(),b.checkALLYesNo=function(){console.log("Check all flag: "+b.checkAll);var a=$("input[name=mySelectedProduct]");if(a.prop("checked",b.checkAll),b.productItems_selected=[],b.checkAll)for(item in b.productItems_copy)b.productItems_selected.push(b.productItems_copy[item]);console.log("Current selected number: "+b.productItems_selected.length)},b.checkItem=function(a){if(console.log("Check item flag: "+a.checked),a.checked)b.productItems_selected.push(a);else for(item in b.productItems_selected)b.productItems_selected[item].id==a.id&&b.productItems_selected.splice(item,1);console.log("Current selected number: "+b.productItems_selected.length);var c=$("#allCheckControl");0==b.productItems_selected.length?c.prop("checked",!1):b.productItems_selected.length==b.productItems_copy.length&&c.prop("checked",!0)},b.actionClickModal=function(a){console.log("Click button: "+a),b.actionSelected=a},b.actionConfirm=function(){console.log("Confirm action: "+b.actionSelected),angular.forEach(b.productItems_selected,function(d){c.get(a+"eden/prods/opes/"+b.actionSelected+"/"+d.id).then(function(a){console.log(b.actionSelected+" product: "+d.name+" successfully"),$(confirmDiag).modal("hide");var c=$("#allCheckControl");c.prop("checked",!1),b.searchProductListByFilters()},function(a){console.log("Failed to "+b.actionSelected+" product: "+d.name)})})}}),b.controller("updateARProductDetail",function(b,c,d,e){console.log("Product ID: "+d.productID),c.get(a+"eden/prods/"+d.productID).then(function(a){console.log("Success to get AR product item: "+d.productID),b.productInfo=a.data},function(a){console.log("Failed to get AR product item")}),c.get(a+"eden/cates/list/levelone").then(function(d){b.levelOneCategoryItems=d.data,d.data.length>0&&(b.levelOneCategory=d.data[0],c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategory.id).then(function(a){b.levelTwoCategoryItems=a.data,a.data.length>0&&(b.levelTwoCategory=a.data[0])},function(a){console.log("Failed to get the second level category")}))},function(a){console.log("Failed to get the first level category")}),b.changeLevelOneCategory=function(){c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategory.id).then(function(a){b.levelTwoCategory={},b.levelTwoCategoryItems=a.data,a.data.length>0&&(b.levelTwoCategory=a.data[0]),console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")})},b.submitProductInfo=function(){b.productInfo.type=1,b.productInfo.publishState=1,b.productInfo.productRecommend=1,b.productInfo.productCategory=b.levelTwoCategory.categoryName,b.productInfo.media="电子书,书籍,教具,益智玩具",b.productInfo.productLevelTwo=b.levelTwoCategory.categoryName,b.productInfo.productMatchScope=3,b.productInfo.productCover="http://12.12.12.12:8080/part2.jpg",b.productInfo.productImages="http://12.12.12.12:8080/part1.jpg,http://12.12.12.12:8080/part2.jpg,http://12.13.12.12:8080/part3.jpg",b.productInfo.productUploadDate=new Date,b.productInfo.productModifyDate=new Date,b.productInfo.productTrialAddr="localhost:8080/images/1.html",b.productInfo.productAppEnabled=0,b.productInfo.productPlayEnabled=0,b.productInfo.productTrialEnabled=0,c.post(a+"eden/prods/update",b.productInfo).then(function(a){200===a.status?(console.log("Update AR product item successfully"),e.setProductBack(!0),e.setType(b.productInfo.type),e.setPublishState(b.productInfo.publishState),e.setProductRecommend(b.productInfo.productRecommend),e.setProductCategory(b.productInfo.productCategory),window.location.href="#product_list/"):console.log("Failed to update AR product item ")},function(a){console.log("Failed to update AR product item ")})}}),b.controller("newARDetailCtrl",function(b,c,d){console.log("Arrived at new AR product detail page already!!"),b.productInfo={},c.get(a+"eden/cates/list/levelone").then(function(d){b.levelOneCategoryItems=d.data,d.data.length>0&&(b.levelOneCategory=d.data[0],c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategory.id).then(function(a){b.levelTwoCategoryItems=a.data,a.data.length>0&&(b.levelTwoCategory=a.data[0])},function(a){console.log("Failed to get the second level category")}))},function(a){console.log("Failed to get the first level category")}),b.changeLevelOneCategory=function(){c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategory.id).then(function(a){b.levelTwoCategory={},b.levelTwoCategoryItems=a.data,a.data.length>0&&(b.levelTwoCategory=a.data[0]),console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")})},b.submitProductInfo=function(){b.productInfo.type=1,b.productInfo.publishState=1,b.productInfo.productRecommend=1,b.productInfo.productCategory=b.levelTwoCategory.categoryName,b.productInfo.media="电子书,书籍,教具,益智玩具",b.productInfo.productLevelTwo=b.levelTwoCategory.categoryName,b.productInfo.productMatchScope=3,b.productInfo.productCover="http://12.12.12.12:8080/part2.jpg",b.productInfo.productImages="http://12.12.12.12:8080/part1.jpg,http://12.12.12.12:8080/part2.jpg,http://12.13.12.12:8080/part3.jpg",b.productInfo.productUploadDate=new Date,b.productInfo.productModifyDate=new Date,b.productInfo.productTrialAddr="localhost:8080/images/1.html",b.productInfo.productAppEnabled=0,b.productInfo.productPlayEnabled=0,b.productInfo.productTrialEnabled=0,c.post(a+"eden/prods/add",b.productInfo).then(function(a){200===a.status?(console.log("Create AR product item successfully"),d.setProductBack(!0),d.setType(b.productInfo.type),d.setPublishState(b.productInfo.publishState),d.setProductRecommend(b.productInfo.productRecommend),d.setProductCategory(b.productInfo.productCategory),window.location.href="#product_list/"):console.log("Failed to create AR product item ")},function(a){console.log("Failed to create AR product item ")})}}),b.controller("updateVideoDetailCtrl",function(b,c,d,e){console.log("Product ID: "+d.productID),c.get(a+"eden/prods/"+d.productID).then(function(a){console.log("Success to get product item: "+d.productID),b.productInfo=a.data},function(a){console.log("Failed to get the product item")}),c.get(a+"eden/cates/list/levelone").then(function(d){b.levelOneCategoryItems=d.data,d.data.length>0&&(b.levelOneCategory=d.data[0],c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategory.id).then(function(a){b.levelTwoCategoryItems=a.data,a.data.length>0&&(b.levelTwoCategory=a.data[0])},function(a){console.log("Failed to get the second level category")}))},function(a){console.log("Failed to get the first level category")}),b.changeLevelOneCategory=function(){c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategory.id).then(function(a){b.levelTwoCategory={},b.levelTwoCategoryItems=a.data,a.data.length>0&&(b.levelTwoCategory=a.data[0]),console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")})},b.selectVideoItem=function(a){b.videoItemSelected=a},b.delVideoItem=function(){for(item in b.productInfo.videoDOs){var a=b.productInfo.videoDOs.indexOf(b.videoItemSelected);a>-1&&(b.productInfo.videoDOs.splice(a,1),console.log("Delete video item index: "+a))}$(deleteVideoItemModal).modal("hide")},b.newVideoItem=function(){var a={};a.videoName=b.videoName,a.videoUrl=b.videoUrl,b.productInfo.videoDOs.push(a),$(newVideoItemModal).modal("hide")},b.submitProductInfo=function(){b.productInfo.productModifyDate=new Date,c.post(a+"eden/prods/update",b.productInfo).then(function(a){200===a.status?(console.log("Update video product item successfully."),e.setProductBack(!0),e.setType(b.productInfo.type),e.setPublishState(b.productInfo.publishState),e.setProductRecommend(b.productInfo.productRecommend),e.setProductCategory(b.productInfo.productCategory),window.location.href="#product_list/"):console.log("Failed to update video product item")},function(a){console.log("Failed to update video product item ")})}}),b.controller("newVideoDetailCtrl",function(b,c){b.productInfo={},b.productInfo.videoDOs=[],c.get(a+"eden/cates/list/levelone").then(function(d){b.levelOneCategoryItems=d.data,d.data.length>0&&(b.levelOneCategory=d.data[0],c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategory.id).then(function(a){b.levelTwoCategoryItems=a.data,a.data.length>0&&(b.levelTwoCategory=a.data[0])},function(a){console.log("Failed to get the second level category")}))},function(a){console.log("Failed to get the first level category")}),b.changeLevelOneCategory=function(){c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategory.id).then(function(a){b.levelTwoCategory={},b.levelTwoCategoryItems=a.data,a.data.length>0&&(b.levelTwoCategory=a.data[0]),console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")})},b.submitProductInfo=function(){b.productInfo.type=0,b.productInfo.publishState=1,b.productInfo.productRecommend=1,b.productInfo.productCategory=b.levelTwoCategory.categoryName,b.productInfo.media="电子书,书籍,教具,益智玩具",b.productInfo.productLevelTwo=b.levelTwoCategory.categoryName,b.productInfo.productCover="http://12.12.12.12:8080/part2.jpg",b.productInfo.productUploadDate=new Date,b.productInfo.productModifyDate=new Date,b.productInfo.productMatchScope=3,c.post(a+"eden/prods/add",b.productInfo).then(function(a){200===a.status?(console.log("Create video product item successfully"),productBackAction.setProductBack(!0),productBackAction.setType(b.productInfo.type),productBackAction.setPublishState(b.productInfo.publishState),productBackAction.setProductRecommend(b.productInfo.productRecommend),productBackAction.setProductCategory(b.productInfo.productCategory),window.location.href="#product_list/"):console.log("Failed to create video product item ")},function(a){console.log("Failed to create video product item ")})},b.selectVideoItem=function(a){b.videoItemSelected=a},b.delVideoItem=function(){for(item in b.productInfo.videoDOs){var a=b.productInfo.videoDOs.indexOf(b.videoItemSelected);a>-1&&(b.productInfo.videoDOs.splice(a,1),console.log("Delete video item index: "+a))}$(deleteVideoItemModal).modal("hide")},b.newVideoItem=function(){var a={};a.videoName=b.videoName,a.videoUrl=b.videoUrl,b.productInfo.videoDOs.push(a),$(newVideoItemModal).modal("hide")}}),b.controller("firstLevelCategoryCtrl",function(b,c){b.firstLevelCategoryItems=null,loading(),c.get(a+"eden/cates/list/levelone").then(function(a){b.firstLevelCategoryItems=a.data},function(a){console.log("Failed to get the first level category")}),b.searchByCategory=function(){if(null===b.firstLevelCategoryItems)return void console.log("The first level category is empty");firstLevelCategoryItems_temp=b.firstLevelCategoryItems,b.firstLevelCategoryItems=[];var a=new RegExp(b.firstCategorySearch,"i");for(item in firstLevelCategoryItems_temp)a.test(firstLevelCategoryItems_temp[item].categoryName)&&b.firstLevelCategoryItems.push(firstLevelCategoryItems_temp[item])},b.deleteItem=function(a){b.selectedFirstLevelCategoryID=a.id,b.selectedFirstLevelCategoryItem=a},b.deleteFirstCategory=function(){c.get(a+"eden/cates/delete/"+b.selectedFirstLevelCategoryID).then(function(d){console.log("Success to delete the first level category ID: "+b.selectedFirstLevelCategoryID),c.get(a+"eden/cates/list/levelone").then(function(a){$(deleteFirstCategoryModal).modal("hide"),b.firstLevelCategoryItems=a.data},function(a){console.log("Failed to get the first level category")})},function(a){console.log("Failed to get the first level category")})},b.updateItem=function(a){b.currentUpdateItem=a,b.levelOneCategoryName=a.categoryName},b.updateFirstCategory=function(){console.log("Update the first level category: "+b.levelOneCategoryName),b.currentUpdateItem.categoryName=b.levelOneCategoryName,c.post(a+"eden/cates/update",b.currentUpdateItem).then(function(d){console.log("Update first category item successfully."),$(updateFirstCategoryModal).modal("hide"),c.get(a+"eden/cates/list/levelone").then(function(a){b.firstLevelCategoryItems=a.data},function(a){console.log("Failed to get the first level category")})},function(a){console.log("Failed to update first category item ")})},b.fieldCheck=function(){"undefined"==typeof b.levelOneCategoryName?b.updateFormInvalid=!0:b.updateFormInvalid=!1},b.createFirstCategory=function(){var d={};d.categoryName=b.newFirstCategoryName,d.categoryUpdateDate=new Date,d.categoryLevel=1,d.categoryPrevious=0,d.categoryDeleted=0,c.post(a+"eden/cates/add",d).then(function(d){console.log("Create first category item successfully."),$(newFirstCategoryModal).modal("hide"),c.get(a+"eden/cates/list/levelone").then(function(a){b.firstLevelCategoryItems=a.data},function(a){console.log("Failed to get the first level category")})},function(a){console.log("Failed to create first category item ")}),b.newFirstCategoryName=""}}),b.controller("secondLevelCategoryCtrl",function(b,c){b.levelTwoCategoryItems=null,b.levelOneCategoryItems=null,b.firstCategorySelected=null,loading(),c.get(a+"eden/cates/list/levelone").then(function(d){b.levelOneCategoryItems=d.data,d.data.length>0&&(b.levelOneCategorySelected=d.data[0],c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategorySelected.id).then(function(a){b.levelTwoCategoryItems=a.data,levelTwoCategoryItems_temp=b.levelTwoCategoryItems,console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")}))},function(a){console.log("Failed to get the first level category")}),levelTwoCategoryItems_temp=[],b.changeLevelOneCategory=function(){c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategorySelected.id).then(function(a){b.levelTwoCategoryItems=a.data,levelTwoCategoryItems_temp=b.levelTwoCategoryItems,console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")})},b.searchByCategory=function(){b.levelTwoCategoryItems=[],"undefined"==typeof b.levelTwoCategoryFilter&&(b.levelTwoCategoryFilter="");var a=new RegExp(b.levelTwoCategoryFilter,"i");for(item in levelTwoCategoryItems_temp)a.test(levelTwoCategoryItems_temp[item].categoryName)&&b.levelTwoCategoryItems.push(levelTwoCategoryItems_temp[item])},b.deleteItem=function(a){b.selectedLevelTwoCategoryID=a.id,b.selectedLevelTwoCategory=a,console.log("Selected id: "+a.id+" selected category name: "+a.categoryName)},b.deleteLevelTwoCategory=function(){c.get(a+"eden/cates/delete/"+b.selectedLevelTwoCategoryID).then(function(d){console.log("Success to delete the second level category ID: "+b.selectedLevelTwoCategoryID),$(deleteLevelTwoCategoryModal).modal("hide"),c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategorySelected.id).then(function(a){b.levelTwoCategoryItems=a.data,levelTwoCategoryItems_temp=b.levelTwoCategoryItems,console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")})},function(a){console.log("Failed to get the second level category")})},b.updateItem=function(a){b.updatedLevelTwoItem=a,b.levelTwoCategoryUpdated=a.categoryName},b.updateLevelTwoCategory=function(){console.log("Update the second level category: "+b.levelTwoCategoryUpdated),b.updatedLevelTwoItem.categoryName=b.levelTwoCategoryUpdated,c.post(a+"eden/cates/update",b.updatedLevelTwoItem).then(function(d){console.log("Update level two category item successfully."),$(updateSecondCategoryModal).modal("hide"),c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategorySelected.id).then(function(a){b.levelTwoCategoryItems=a.data,levelTwoCategoryItems_temp=b.levelTwoCategoryItems,console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")})},function(a){console.log("Failed to update level two category item ")})},b.updateFormValidate=function(){b.updateFormInvalid=!1,""===b.levelTwoCategoryUpdated&&(b.updateFormInvalid=!0)},b.createLevelTwoCategory=function(){var d={};d.categoryName=b.levelTwoCategoryForLevelTwoCreation,d.categoryLevel=2,d.categoryUpdateDate=new Date,d.categoryPrevious=b.levelOneCategoryForLevelTwoCreation.id,d.categoryDeleted=0,c.post(a+"eden/cates/add",d).then(function(d){console.log("Create level two category item successfully."),$(newLevelTwoCategoryModal).modal("hide"),c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategorySelected.id).then(function(a){b.levelTwoCategoryItems=a.data,levelTwoCategoryItems_temp=b.levelTwoCategoryItems,console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")})},function(a){console.log("Failed to create level two category item ")})},b.createFormValidate=function(){b.createFormInvalid=!1,null!==b.levelOneCategoryForLevelTwoCreation&&""!==b.levelTwoCategoryForLevelTwoCreation||(b.createFormInvalid=!0)}}),b.controller("userAdminCtrl",function(b,c){b.userItems=null,loading(),console.log("Invoke user admin controller, get user admin list data"),c.get(a+"eden/membs/lists").then(function(a){b.userItems=a.data,userItems_temp=a.data},function(a){console.log("Failed to get admin user list")}),b.searchUserListByPhone=function(){b.userItems=[];var a=new RegExp(b.searchPhoneNumber,"i");for(item in userItems_temp)a.test(userItems_temp[item].memberMobile)&&b.userItems.push(userItems_temp[item])},b.resetPWD=function(a){b.selectedUserID=a.id,b.selectedUserItem=a,console.log("Selected user id: "+b.selectedUserID)},b.confirmResetPWD=function(){console.log("Confirmed to reset member name: "+b.selectedUserItem.memberName)}}),b.controller("logDownloadCtrl",function(b,c){b.logItems=null,loading(),console.log("Invoke log list controller, get download log list"),c.get(a+"eden/logs/lists").then(function(a){b.logItems=a.data},function(a){console.log("Failed to get log list")})}),b.controller("otherUrlCtrl",function(){console.log("Otherwise URL contoller...")}),loading=function(){var a=$("#loadingScreen"),b=a.width();a.css("margin-left",b>441?(b-441)/2:"0px"),$(window).resize(function(){var a=$("#loadingScreen"),b=a.width();a.css("margin-left",b>441?(b-441)/2:"0px")})}}());