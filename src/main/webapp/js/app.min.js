/*! 
* FUNP - v1.0.0 
* Â© Copyright 2016  Liangli Huang
 */
$(function(){var a="http://118.178.124.197:8080/",b=angular.module("app",["ngRoute"]);b.config(function(a){a.when("/primary_product",{templateUrl:"app/views/product/primary_product.html",controller:"primaryProductCtrl"}).when("/product_list",{templateUrl:"app/views/product/product_list.html",controller:"productListCtrl"}).when("/new_ar_product_detail/:productID",{templateUrl:"app/views/product/new_ar_product_detail.html",controller:"updateARProductDetail"}).when("/new_ar_product_detail",{templateUrl:"app/views/product/new_ar_product_detail.html",controller:"newARDetailCtrl"}).when("/new_video_product_detail",{templateUrl:"app/views/product/new_video_product_detail.html",controller:"newVideoDetailCtrl"}).when("/first_level_category",{templateUrl:"app/views/category/first_level_category.html",controller:"firstLevelCategoryCtrl"}).when("/second_level_category",{templateUrl:"app/views/category/second_level_category.html",controller:"secondLevelCategoryCtrl"}).when("/user_admin",{templateUrl:"app/views/user/user_admin.html",controller:"userAdminCtrl"}).when("/log_download",{templateUrl:"app/views/log/log_download.html",controller:"logDownloadCtrl"}).otherwise("/primary_product",{templateUrl:"app/views/product/primary_product.html",controller:"otherUrlCtrl"})}),b.controller("primaryProductCtrl",function(){console.log("Arrived at primary product page already!!")}),b.controller("productListCtrl",function(b,c){b.productItems=null,b.productItems_selected=[],b.actionSelected="",b.productItems_copy=[],loading(),getProductListByFilters=function(){var d={};d.type=$("#product_type").prop("selectedIndex"),d.publishState=$("#release_state").prop("selectedIndex"),d.productRecommend=$("#recommendation").prop("selectedIndex"),d.productCategory=$("#product_category").val(),c.post(a+"eden/prods/lists",d).then(function(a){console.log("Get product list by filter successfully."),b.productItems=a.data,b.productItems_copy=a.data,b.productItems_selected=[]},function(a){console.log("Failed to get product list by filter")})},console.log("Invoke product list controller, get product list data from remote here!"),b.searchProductListByFilters=function(){console.log("Starting to search product items by filters..."),console.log("Selected product category: "+$("#product_category").val()+" Selected index: "+$("#product_category").prop("selectedIndex")),console.log("Selected product type: "+$("#product_type").val()+" Selected index: "+$("#product_type").prop("selectedIndex")),console.log("Selected release state: "+$("#release_state").val()+" Selected index: "+$("#release_state").prop("selectedIndex")),console.log("Selected recommendation: "+$("#recommendation").val()+" Selected index: "+$("#recommendation").prop("selectedIndex")),getProductListByFilters()},b.searchProductListByFilters(),b.checkALLYesNo=function(){console.log("Check all flag: "+b.checkAll);var a=$("input[name=mySelectedProduct]");if(a.prop("checked",b.checkAll),b.productItems_selected=[],b.checkAll)for(item in b.productItems_copy)b.productItems_selected.push(b.productItems_copy[item]);console.log("Current selected number: "+b.productItems_selected.length)},b.checkItem=function(a){if(console.log("Check item flag: "+a.checked),a.checked)b.productItems_selected.push(a);else for(item in b.productItems_selected)b.productItems_selected[item].id==a.id&&b.productItems_selected.splice(item,1);console.log("Current selected number: "+b.productItems_selected.length);var c=$("#allCheckControl");0==b.productItems_selected.length?c.prop("checked",!1):b.productItems_selected.length==b.productItems_copy.length&&c.prop("checked",!0)},b.resetSearch=function(){b.productItems=b.productItems_copy,b.searchProductListByFilters()},b.actionClickModal=function(a){console.log("Click button: "+a),b.actionSelected=a},b.actionConfirm=function(){console.log("Confirm action: "+b.actionSelected),angular.forEach(b.productItems_selected,function(d){c.get(a+"eden/prods/opes/"+b.actionSelected+"/"+d.id).then(function(a){console.log(b.actionSelected+" product: "+d.name+" successfully"),getProductListByFilters()},function(a){console.log("Failed to "+b.actionSelected+" product: "+d.name)})}),$(confirmDiag).modal("hide")}}),b.controller("updateARProductDetail",function(a){console.log("Product ID: "+a.productID)}),b.controller("newARDetailCtrl",function(){console.log("Arrived at new AR product detail page already!!")}),b.controller("newVideoDetailCtrl",function(){console.log("Arrived at new video product detail page already!!")}),b.controller("firstLevelCategoryCtrl",function(b,c){b.firstLevelCategoryItems=null,loading(),c.get(a+"eden/cates/list/levelone").then(function(a){b.firstLevelCategoryItems=a.data},function(a){console.log("Failed to get the first level category")}),b.searchByCategory=function(){if(null===b.firstLevelCategoryItems)return void console.log("The first level category is empty");firstLevelCategoryItems_temp=b.firstLevelCategoryItems,b.firstLevelCategoryItems=[];var a=new RegExp(b.firstCategorySearch,"i");for(item in firstLevelCategoryItems_temp)a.test(firstLevelCategoryItems_temp[item].categoryName)&&b.firstLevelCategoryItems.push(firstLevelCategoryItems_temp[item])},b.deleteItem=function(a){b.selectedFirstLevelCategoryID=a.id,b.selectedFirstLevelCategoryItem=a},b.deleteFirstCategory=function(){c.get(a+"eden/cates/delete/"+b.selectedFirstLevelCategoryID).then(function(d){console.log("Success to delete the first level category ID: "+b.selectedFirstLevelCategoryID),c.get(a+"eden/cates/list/levelone").then(function(a){$(deleteFirstCategoryModal).modal("hide"),b.firstLevelCategoryItems=a.data},function(a){console.log("Failed to get the first level category")})},function(a){console.log("Failed to get the first level category")})},b.updateItem=function(a){b.currentUpdateItem=a,b.levelOneCategoryName=a.categoryName},b.updateFirstCategory=function(){console.log("Update the first level category: "+b.levelOneCategoryName),b.currentUpdateItem.categoryName=b.levelOneCategoryName,c.post(a+"eden/cates/update",b.currentUpdateItem).then(function(d){console.log("Update first category item successfully."),$(updateFirstCategoryModal).modal("hide"),c.get(a+"eden/cates/list/levelone").then(function(a){b.firstLevelCategoryItems=a.data},function(a){console.log("Failed to get the first level category")})},function(a){console.log("Failed to update first category item ")})},b.fieldCheck=function(){"undefined"==typeof b.levelOneCategoryName?b.updateFormInvalid=!0:b.updateFormInvalid=!1},b.createFirstCategory=function(){var d={};d.categoryName=b.newFirstCategoryName,d.categoryUpdateDate=new Date,d.categoryLevel=1,d.categoryPrevious=0,d.categoryDeleted=0,c.post(a+"eden/cates/add",d).then(function(d){console.log("Create first category item successfully."),$(newFirstCategoryModal).modal("hide"),c.get(a+"eden/cates/list/levelone").then(function(a){b.firstLevelCategoryItems=a.data},function(a){console.log("Failed to get the first level category")})},function(a){console.log("Failed to create first category item ")}),b.newFirstCategoryName=""}}),b.controller("secondLevelCategoryCtrl",function(b,c){b.levelTwoCategoryItems=null,b.levelOneCategoryItems=null,b.firstCategorySelected=null,loading(),c.get(a+"eden/cates/list/levelone").then(function(d){b.levelOneCategoryItems=d.data,d.data.length>0&&(b.levelOneCategorySelected=d.data[0],c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategorySelected.id).then(function(a){b.levelTwoCategoryItems=a.data,levelTwoCategoryItems_temp=b.levelTwoCategoryItems,console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")}))},function(a){console.log("Failed to get the first level category")}),levelTwoCategoryItems_temp=[],b.changeLevelOneCategory=function(){c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategorySelected.id).then(function(a){b.levelTwoCategoryItems=a.data,levelTwoCategoryItems_temp=b.levelTwoCategoryItems,console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")})},b.searchByCategory=function(){b.levelTwoCategoryItems=[],"undefined"==typeof b.levelTwoCategoryFilter&&(b.levelTwoCategoryFilter="");var a=new RegExp(b.levelTwoCategoryFilter,"i");for(item in levelTwoCategoryItems_temp)a.test(levelTwoCategoryItems_temp[item].categoryName)&&b.levelTwoCategoryItems.push(levelTwoCategoryItems_temp[item])},b.deleteItem=function(a){b.selectedLevelTwoCategoryID=a.id,b.selectedLevelTwoCategory=a,console.log("Selected id: "+a.id+" selected category name: "+a.categoryName)},b.deleteLevelTwoCategory=function(){c.get(a+"eden/cates/delete/"+b.selectedLevelTwoCategoryID).then(function(d){console.log("Success to delete the second level category ID: "+b.selectedLevelTwoCategoryID),$(deleteLevelTwoCategoryModal).modal("hide"),c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategorySelected.id).then(function(a){b.levelTwoCategoryItems=a.data,levelTwoCategoryItems_temp=b.levelTwoCategoryItems,console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")})},function(a){console.log("Failed to get the second level category")})},b.updateItem=function(a){b.updatedLevelTwoItem=a,b.levelTwoCategoryUpdated=a.categoryName},b.updateLevelTwoCategory=function(){console.log("Update the second level category: "+b.levelTwoCategoryUpdated),b.updatedLevelTwoItem.categoryName=b.levelTwoCategoryUpdated,c.post(a+"eden/cates/update",b.updatedLevelTwoItem).then(function(d){console.log("Update level two category item successfully."),$(updateSecondCategoryModal).modal("hide"),c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategorySelected.id).then(function(a){b.levelTwoCategoryItems=a.data,levelTwoCategoryItems_temp=b.levelTwoCategoryItems,console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")})},function(a){console.log("Failed to update level two category item ")})},b.updateFormValidate=function(){b.updateFormInvalid=!1,""===b.levelTwoCategoryUpdated&&(b.updateFormInvalid=!0)},b.createLevelTwoCategory=function(){var d={};d.categoryName=b.levelTwoCategoryForLevelTwoCreation,d.categoryLevel=2,d.categoryUpdateDate=new Date,d.categoryPrevious=b.levelOneCategoryForLevelTwoCreation.id,d.categoryDeleted=0,c.post(a+"eden/cates/add",d).then(function(d){console.log("Create level two category item successfully."),$(newLevelTwoCategoryModal).modal("hide"),c.get(a+"eden/cates/list/leveltwo/"+b.levelOneCategorySelected.id).then(function(a){b.levelTwoCategoryItems=a.data,levelTwoCategoryItems_temp=b.levelTwoCategoryItems,console.log("Success to get the second level category")},function(a){console.log("Failed to get the second level category")})},function(a){console.log("Failed to create level two category item ")})},b.createFormValidate=function(){b.createFormInvalid=!1,null!==b.levelOneCategoryForLevelTwoCreation&&""!==b.levelTwoCategoryForLevelTwoCreation||(b.createFormInvalid=!0)}}),b.controller("userAdminCtrl",function(b,c){b.userItems=null,loading(),console.log("Invoke user admin controller, get user admin list data"),c.get(a+"eden/membs/lists").then(function(a){b.userItems=a.data,userItems_temp=a.data},function(a){console.log("Failed to get admin user list")}),b.searchUserListByPhone=function(){b.userItems=[];var a=new RegExp(b.searchPhoneNumber,"i");for(item in userItems_temp)a.test(userItems_temp[item].memberMobile)&&b.userItems.push(userItems_temp[item])},b.resetPWD=function(a){b.selectedUserID=a.id,b.selectedUserItem=a,console.log("Selected user id: "+b.selectedUserID)},b.confirmResetPWD=function(){console.log("Confirmed to reset member name: "+b.selectedUserItem.memberName)}}),b.controller("logDownloadCtrl",function(b,c){b.logItems=null,loading(),console.log("Invoke log list controller, get download log list"),c.get(a+"eden/logs/lists").then(function(a){b.logItems=a.data},function(a){console.log("Failed to get log list")})}),b.controller("otherUrlCtrl",function(){console.log("Otherwise URL contoller...")}),loading=function(){var a=$("#loadingScreen"),b=a.width();a.css("margin-left",b>441?(b-441)/2:"0px"),$(window).resize(function(){var a=$("#loadingScreen"),b=a.width();a.css("margin-left",b>441?(b-441)/2:"0px")})}}());